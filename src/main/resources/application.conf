ktor {
    deployment {
        port = 8080
        port = ${?PORT}
    }
    application {
        id = "k9-joark"
        modules = [no.nav.helse.K9JoarkKt.k9Joark]
    }
}

no.nav.security.jwt {
  issuers = [
      {
        issuer_name = azure-v1
        discoveryurl = ${?AZURE_V1_DISCOVERY_ENDPOINT}
        accepted_audience = ${?AZURE_APP_CLIENT_ID}
      },
      {
        issuer_name = azure-v2
        discoveryurl = ${?AZURE_APP_WELL_KNOWN_URL}
        accepted_audience = ${?AZURE_APP_CLIENT_ID}
      }
  ]
}

nav {
    dokarkiv_base_url = ""
    dokarkiv_base_url = ${?DOKARKIV_BASE_URL}
    k9_mellomlagring_base_url = ${?K9_MELLOMLAGRING_BASE_URL}
    auth {
        clients = [{
            alias = "nais-sts"
            client_id = "srvk9-joark"
            client_id = ${?SERVICE_ACCOUNT_CLIENT_ID}
            client_secret = ""
            client_secret = ${?SERVICE_ACCOUNT_CLIENT_SECRET}
            discovery_endpoint = ""
            discovery_endpoint = ${?NAIS_STS_DISCOVERY_ENDPOINT}
        },{
            alias = "azure-v2"
            client_id = ""
            client_id = ${?AZURE_APP_CLIENT_ID}
            private_key_jwk = ""
            private_key_jwk = ${?AZURE_APP_JWK}
            discovery_endpoint = ""
            discovery_endpoint = ${?AZURE_APP_WELL_KNOWN_URL}
        }]
        scopes = {
            opprette-journalpost = "openid"
            k9-dokument-scope = ""
            k9-dokument-scope = ${?K9_DOKUMENT_SCOPE}
            k9-mellomlagring-scope = ""
            k9-mellomlagring-scope = ${?K9_MELLOMLAGRING_SCOPE}
        }
    }
}
